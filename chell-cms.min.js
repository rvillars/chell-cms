"use strict";var chellCms=angular.module("chell-cms",["templates-chell-cms","ngTable","underscore","angular-underscore","ui.bootstrap","base64","ngMockE2E"]),chellCms=angular.module("chell-cms");chellCms.factory("CmsContent",["CmsAdapter",function(a){return{query:function(){return a.getContentList()},get:function(b){return a.getContent(b)},create:function(b){return a.createContent(b)},update:function(b){return a.updateContent(b)},remove:function(b){return a.removeContent(b)}}}]);var chellCms=angular.module("chell-cms");chellCms.directive("chellWebContent",function(){return{restrict:"E",controller:"WebContentController",templateUrl:"templates/web-content.tpl.html"}}),chellCms.directive("chellContentManager",function(){return{restrict:"E",controller:"ContentManagerController",templateUrl:"templates/content-manager.tpl.html"}});var chellCms=angular.module("chell-cms");chellCms.controller("WebContentController",["$scope","$sce","$modal","$attrs","CmsContent",function(a,b,c,d,e){a.contentId=a.$eval(d.contentId),e.get(a.contentId).then(function(b){a.content=b}),a.edit=function(){a.modalInstance=c.open({templateUrl:"templates/content-selection-dialog.tpl.html",backdrop:"false",keyboard:"true",controller:"CmsSelectionModalController",windowClass:"modal-wide",resolve:{content:function(){return a.content}}}),a.modalInstance.result.then(function(b){a.contentId=b,e.get(a.contentId).then(function(b){a.content=b})})},a.save=function(){a.editor&&(a.content=a.editor.getData(),a.editor.destroy(),a.editor=null)},a.toTrusted=function(a){return b.trustAsHtml(a)}}]),chellCms.controller("ContentManagerController",["$scope","ngTableParams","CmsContent","$modal",function(a,b,c,d){a.list=!0,a.detail=!1,a.contentList=[],a.editContent={},a.editor=null,a.config={},a.$watchCollection("contentList",function(){a.tableParams&&a.tableParams.reload()}),c.query().then(function(c){a.contentList=c,a.tableParams=new b({page:1,count:10},{total:a.contentList.length,getData:function(b,c){b.resolve(a.data=a.contentList.slice((c.page()-1)*c.count(),c.page()*c.count()))},$scope:{$data:{},$emit:function(){}}})}),a.create=function(){a.edit({})},a.view=function(b){a.modalInstance=d.open({templateUrl:"templates/content-view-dialog.tpl.html",backdrop:"false",keyboard:"true",controller:"CmsViewModalController",windowClass:"modal-wide",resolve:{content:function(){return b}}})},a.edit=function(b){a.editContent=b,a.editor||(a.editor=CKEDITOR.appendTo("inputBody",a.config,a.editContent.body),a.showDetail())},a.remove=function(b){confirm("Are you sure?")&&c.remove(b).then(function(){a.contentList.splice(a.contentList.indexOf(b),1)})},a.save=function(){a.editContent.body=a.editor.getData();var b=null==a.editContent.id;b?c.create(a.editContent).then(function(b){a.contentList.push(b)}):c.update(a.editContent).then(function(){}),null!=a.editor&&(a.editor.destroy(),a.editor=null),a.cancel()},a.cancel=function(){a.editContent={},null!=a.editor&&(a.editor.destroy(),a.editor=null),a.showList()},a.showList=function(){a.list=!0,a.detail=!1},a.showDetail=function(){a.list=!1,a.detail=!0}}]),chellCms.controller("CmsViewModalController",["$scope","$modalInstance","$sce","content",function(a,b,c,d){a.content=d,a.toTrusted=function(a){return c.trustAsHtml(a)},a.cancel=function(){b.dismiss("cancel")}}]),chellCms.controller("CmsSelectionModalController",["$scope","$modalInstance","content",function(a,b,c){a.selectedRow=c,a.contentId=c.id,a.selectedRow.$selected=!0,a.cancel=function(){b.dismiss("cancel")},a.ok=function(){b.close(a.contentId)},a.changeSelection=function(b){a.selectedRow&&(a.selectedRow.$selected=!1),a.selectedRow=b,a.contentId=b.id}}]),angular.module("templates-chell-cms",["templates/content-manager.tpl.html","templates/content-selection-dialog.tpl.html","templates/content-view-dialog.tpl.html","templates/web-content.tpl.html"]),angular.module("templates/content-manager.tpl.html",[]).run(["$templateCache",function(a){a.put("templates/content-manager.tpl.html",'<div ng-controller="ContentManagerController">\n    <div ng-show="list">\n        <button class="btn btn-primary btn-xs" ng-click="create()"><i style="padding-right: 10px" class="glyphicon glyphicon-edit"></i>Create Content</button>\n        <table ng-table="tableParams" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="datatable">\n            <tbody>\n            <tr ng-repeat="content in data">\n                <td data-title="\'Title\'">{{content.title}}</td>\n                <td data-title="\'Creation Date\'" class="center">{{content.creationDate | date:\'dd.MM.yyyy\'}}</td>\n                <td data-title="\'Content ID\'" class="center">{{content.id}}</td>\n                <td data-title="\'Access Rights\'" class="center">{{content.accessRights}}</td>\n                <td data-title="\'State\'" class="center">\n                    <span class="badge">{{content.status}}</span>\n                </td>\n                <td data-title="\'Actions\'" class="center">\n                    <div class="btn-group btn-group-sm">\n                        <button class="btn btn-default" title="View" ng-click="view(content)">\n                            <i class="glyphicon glyphicon-zoom-in icon-white"></i>\n                        </button>\n                        <button class="btn btn-default" title="Edit" ng-click="edit(content)">\n                            <i class="glyphicon glyphicon-edit icon-white"></i>\n                        </button>\n                        <button class="btn btn-default" title="Delete" ng-click="remove(content)">\n                            <i class="glyphicon glyphicon-trash icon-white"></i>\n                        </button>\n                    </div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <div ng-show="detail">\n        <form id="userProfile">\n            <fieldset>\n                <div class="form-group">\n                    <label for="inputUserId">Content ID</label>\n                    <input class="form-control" id="inputUserId" placeholder="Automatically generated" readonly="true" ng-model="editContent.id">\n                </div>\n                <div class="form-group">\n                    <label for="inputTitle">Title</label>\n                    <input class="form-control" id="inputTitle" placeholder="Title" required="true" ng-model="editContent.title">\n                </div>\n                <div id="inputBody"/>\n                <div class="form-group">\n                    <label for="inputStatus">Status</label>\n                    <select class="form-control" id="inputStatus" ng-model="editContent.status" ng-value="\'approved\'">\n                        <option>approved</option>\n                        <option>draft</option>\n                    </select>\n                </div>\n            </fieldset>\n            <button type="submit" class="btn btn-primary" ng-click="save()">Save</button>\n            <button class="btn btn-default" ng-click="cancel()">Cancel</button>\n        </form>\n    </div>\n</div>')}]),angular.module("templates/content-selection-dialog.tpl.html",[]).run(["$templateCache",function(a){a.put("templates/content-selection-dialog.tpl.html",'<div class="modal-header">\n    <button class="close" ng-click="cancel()">×</button>\n    <h3>Select Content</h3>\n</div>\n<div class="modal-body" ng-controller="ContentManagerController">\n    <table ng-table="tableParams" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="datatable">\n        <tbody>\n        <tr ng-repeat="content in data"\n            ng-click="content.$selected = !content.$selected; changeSelection(content)"\n            ng-class="{\'active\': content.$selected}">\n            <td data-title="\'Title\'">{{content.title}}</td>\n            <td data-title="\'Creation Date\'" class="center">{{content.creationDate | date:\'dd.MM.yyyy\'}}</td>\n            <td data-title="\'Content ID\'" class="center">{{content.id}}</td>\n            <td data-title="\'Access Rights\'" class="center">{{content.accessRights}}</td>\n            <td data-title="\'State\'" class="center">\n                <span class="badge">{{content.status}}</span>\n            </td>\n            <td data-title="\'Actions\'" class="center">\n                <div class="btn-group btn-group-sm">\n                    <button class="btn btn-default" title="View" ng-click="view(content)">\n                        <i class="glyphicon glyphicon-zoom-in icon-white"></i>\n                    </button>\n                </div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n</div>\n<div class="modal-footer">\n    <button class="btn" ng-click="cancel()">Cancel</button>\n    <button class="btn btn-primary" ng-click="ok()">Save</button>\n</div>\n\n')}]),angular.module("templates/content-view-dialog.tpl.html",[]).run(["$templateCache",function(a){a.put("templates/content-view-dialog.tpl.html",'<div class="modal-header">\n    <button class="close" ng-click="cancel()">×</button>\n    <h3>{{content.title}}</h3>\n</div>\n<div class="modal-body">\n    <div ng-bind-html="toTrusted(content.body)"></div>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-primary" ng-click="cancel()">Close</button>\n</div>\n\n')}]),angular.module("templates/web-content.tpl.html",[]).run(["$templateCache",function(a){a.put("templates/web-content.tpl.html",'<div class="webcontent">\n    <a visibility-role-id="101" class="btn btn-xs" id="webcontent-edit-button" ng-hide="editor" ng-click="edit()" style="float: right;"><i class="glyphicon glyphicon-edit"></i></a>\n    <div ng-bind-html="toTrusted(content.body)"></div>\n    <button class="btn btn-primary" ng-show="editor" ng-click="save()"><i style="padding-right: 10px" class="glyphicon glyphicon-check"></i>Save</button>\n</div>\n\n\n\n\n')}]);